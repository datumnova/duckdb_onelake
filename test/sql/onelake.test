# name: test/sql/onelake.test
# description: test onelake extension
# group: [sql]

LOAD './extension/onelake/onelake.duckdb_extension';
set azure_transport_option_type = 'curl';
CREATE SECRET  (
    TYPE azure,
    PROVIDER service_principal,
    TENANT_ID '${AZURE_TENANT_ID}',
    CLIENT_ID '${AZURE_CLIENT_ID}',
    CLIENT_SECRET '${AZURE_CLIENT_SECRET}'
);

CREATE SECRET onelake (
    TYPE ONELAKE,
    TENANT_ID '${AZURE_TENANT_ID}',
    CLIENT_ID '${AZURE_CLIENT_ID}',
    CLIENT_SECRET '${AZURE_CLIENT_SECRET}'
);

ATTACH 'onelake://${AZURE_WORKSPACE_ID}'
      AS <your_connection_name>
      (TYPE ONELAKE, DEFAULT_LAKEHOUSE '<your_lakehouse_id_or_name>');

USE <your_connection_name>;

SELECT * FROM <your_table_name> LIMIT 10;
SELECT * FROM <second_lakehouse>.<your_table_name> LIMIT 10;

